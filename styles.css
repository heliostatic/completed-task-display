/* Hide completed tasks in preview/reading mode - only [x] and [X] */
/* Note: Edit mode toggling is handled by CodeMirror extension, so no body class needed there */
/* But preview mode needs the body class to respect the toggle */
body.hide-completed-tasks .markdown-preview-view ul > li.task-list-item[data-task="x"],
body.hide-completed-tasks .markdown-preview-view ul > li.task-list-item[data-task="X"] {
    display: none;
}

/* Hide sub-bullets under completed tasks in preview/reading mode */
body.hide-completed-tasks .markdown-preview-view li.task-list-item[data-task="x"] ul,
body.hide-completed-tasks .markdown-preview-view li.task-list-item[data-task="X"] ul {
    display: none;
}

/* Hide completed task lines that have been replaced by our decorations */
/* When a replace decoration is active, the line has data-task="x" but NO label (checkbox was removed) */
/* AND it only contains widget buffers and contenteditable=false spans (content was replaced) */
.markdown-source-view.mod-cm6 .cm-content > div.cm-line[data-task="x"]:not(:has(label)):has([contenteditable="false"]),
.markdown-source-view.mod-cm6 .cm-content > div.cm-line[data-task="X"]:not(:has(label)):has([contenteditable="false"]),
.markdown-source-view .cm-content > div.cm-line[data-task="x"]:not(:has(label)):has([contenteditable="false"]),
.markdown-source-view .cm-content > div.cm-line[data-task="X"]:not(:has(label)):has([contenteditable="false"]) {
    display: none !important;
    height: 0 !important;
    min-height: 0 !important;
    max-height: 0 !important;
    padding: 0 !important;
    margin: 0 !important;
    line-height: 0 !important;
    overflow: hidden !important;
    visibility: hidden !important;
}

/* Hide sub-bullets that have been replaced - must have HyperMD-list-line class and no visible content */
/* This ensures we only hide actual list items, not random empty lines */
.markdown-source-view.mod-cm6 .cm-content > div.cm-line.HyperMD-list-line:not(:has(label)):not(:has(.cm-list-1)):not(:has(.cm-list-2)):has([contenteditable="false"]),
.markdown-source-view .cm-content > div.cm-line.HyperMD-list-line:not(:has(label)):not(:has(.cm-list-1)):not(:has(.cm-list-2)):has([contenteditable="false"]) {
    display: none !important;
    height: 0 !important;
    min-height: 0 !important;
    max-height: 0 !important;
    padding: 0 !important;
    margin: 0 !important;
    line-height: 0 !important;
    overflow: hidden !important;
    visibility: hidden !important;
}

/* Hide gutter line numbers for hidden lines (those with height: 0) */
/* When replace decorations hide content, the gutter elements get height: 0 but are still rendered */
.cm-lineNumbers .cm-gutterElement[style*="height: 0px"] {
    display: none !important;
    visibility: hidden !important;
    height: 0 !important;
    margin: 0 !important;
    padding: 0 !important;
}
